<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personalities - Ultimate Meme Feed</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        .personalities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .personality-card {
            background: #fff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            text-align: center;
            padding-bottom: 15px;
        }
        body:not(.light-mode) .personality-card {
            background: #2a2a2a;
            color: #fff;
        }
        .personality-card:hover {
            transform: translateY(-5px);
        }
        .personality-card img {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }
        .personality-info {
            padding: 15px;
        }
        .personality-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .personality-text {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 15px;
            font-style: italic;
        }
        .import-btn {
            background: #ff4b2b;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.2s;
        }
        .import-btn:hover {
            background: #e04022;
        }
        .import-btn:disabled {
            background: #555;
            cursor: not-allowed;
        }
        .back-nav {
            padding: 20px;
            text-align: center;
        }
        .back-btn {
            background: transparent;
            border: 2px solid #ff4b2b;
            color: #ff4b2b;
            padding: 8px 16px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: bold;
        }
        .back-btn:hover {
            background: #ff4b2b;
            color: white;
        }
    </style>
</head>
<body>

    <header>
        <div class="nav-container">
            <div class="logo">ðŸ”¥ MemePersonalities</div>
            <div class="nav-controls">
                <a href="index.html" class="nav-btn">Back to App</a>
                <button class="nav-btn" onclick="toggleTheme()">
                    <i class="fas fa-adjust"></i>
                </button>
            </div>
        </div>
    </header>

    <div class="back-nav">
        <h2>Choose Your Personality</h2>
        <p>Import these personalities into your feed to simulate their presence.</p>
    </div>

    <div id="personalities-container" class="personalities-grid">
        <div class="loading"></div>
    </div>

    <script>
        // Simple Theme Logic for this page
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const isLight = document.body.classList.contains('light-mode');
            localStorage.setItem('theme', isLight ? 'light' : 'dark');
        }

        // Load Theme preference
        // We read from memeAppState to be consistent if possible, but for simplicity let's check class
        const savedStateStr = localStorage.getItem('memeAppState');
        if (savedStateStr) {
            const savedState = JSON.parse(savedStateStr);
            if (!savedState.preferences.darkMode) {
                document.body.classList.add('light-mode');
            }
        } else {
             // Fallback
             if (localStorage.getItem('theme') === 'light') {
                 document.body.classList.add('light-mode');
             }
        }


        async function fetchPersonalities() {
            try {
                const response = await fetch('personalities.json');
                const data = await response.json();
                renderPersonalities(data);
            } catch (error) {
                console.error('Error fetching personalities:', error);
                document.getElementById('personalities-container').innerHTML = '<p>Error loading personalities.</p>';
            }
        }

        function renderPersonalities(personalities) {
            const container = document.getElementById('personalities-container');
            container.innerHTML = '';

            personalities.forEach(p => {
                const card = document.createElement('div');
                card.className = 'personality-card';
                card.innerHTML = `
                    <img src="${p.image}" alt="${p.name}">
                    <div class="personality-info">
                        <div class="personality-name">${p.name}</div>
                        <div class="personality-text">"${p.text}"</div>
                        <button class="import-btn" onclick="importPersonality('${p.id}')">Import Personality</button>
                    </div>
                `;
                container.appendChild(card);
            });

            // Store data globally for access
            window.personalitiesData = personalities;
        }

        function importPersonality(id) {
            const p = window.personalitiesData.find(item => item.id === id);
            if (!p) return;

            const savedStateStr = localStorage.getItem('memeAppState');
            let state = savedStateStr ? JSON.parse(savedStateStr) : {
                memes: [],
                savedMemes: [],
                preferences: { darkMode: true, source: 'all', muted: false },
                engagement: {},
                pagination: {},
                view: 'feed',
                importedPersonalities: []
            };

            if (!state.importedPersonalities) {
                state.importedPersonalities = [];
            }

            if (!state.importedPersonalities.some(existing => existing.id === id)) {
                state.importedPersonalities.push(p);
                localStorage.setItem('memeAppState', JSON.stringify(state));
                alert(`${p.name} imported successfully!`);
            } else {
                alert(`${p.name} is already imported.`);
            }
        }

        fetchPersonalities();
    </script>
</body>
</html>
